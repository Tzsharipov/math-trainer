<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¢—Ä–µ–Ω–∞–∂—ë—Ä üéì</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      visibility: hidden;
      overflow: hidden;
      font-family: 'Comic Sans MS', 'Arial', sans-serif;
      opacity: 0;
      transition: opacity 0.3s ease-in-out;
    }
    
    body.loaded {
      visibility: visible;
      opacity: 1;
    }
    
    .container {
      width: 100vw;
      height: 100vh;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #87CEEB;
    }
    
    .image-wrapper {
      position: relative;
      display: inline-block;
      max-width: 100%;
      max-height: 100vh;
    }
    
    .background-image {
      display: block;
      width: 100%;
      height: auto;
      max-height: 100vh;
    }
    
    .clickable-zones {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: space-between;
      align-items: flex-end;
      padding: 3%;
      pointer-events: none;
      z-index: 2;
    }
    
    .zone {
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
      pointer-events: all;
    }
    
    /* –í–∏–¥–∏–º—ã–µ –∫–Ω–æ–ø–∫–∏ - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–∞—Ä—Ç–∏–Ω–∫–∏ */
    .btn {
      width: 15%;
      min-width: 100px;
      max-width: 180px;
      padding: 2% 2%;
      background: linear-gradient(135deg, #FFD700, #FFA500);
      border: 3px solid #fff;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      font-size: clamp(9px, 2.5vw, 16px);
      font-weight: 900;
      color: #020004;
      text-align: center;
      text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.5);
      transition: all 0.3s ease;
      animation: bounce 2s infinite;
    }
    
    @media (min-width: 768px) {
      .btn {
        min-width: 120px;
        padding: 2% 3%;
        border: 4px solid #fff;
        border-radius: 20px;
        font-size: clamp(11px, 1.3vw, 16px);
      }
    }
    
    .zone-left .btn {
      background: linear-gradient(135deg, #FF6B6B, #FF8E53);
    }
    
    .zone-left:hover .btn {
      background: linear-gradient(135deg, #FFF59D, #FFEB3B);
    }
    
    .zone-right .btn {
      background: linear-gradient(135deg, #4ECDC4, #44A08D);
    }
    
    .zone-right:hover .btn {
      background: linear-gradient(135deg, #81D4FA, #4FC3F7);
    }
    
    .zone:hover .btn {
      transform: scale(1.15) rotate(-2deg);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
    }
    
    .zone:active .btn {
      transform: scale(0.95);
    }
    
    /* –°–º–µ–Ω–∞ —Ç–µ–∫—Å—Ç–∞ –ø—Ä–∏ hover */
    .zone:hover .btn-text {
      display: none;
    }
    
    .zone:hover .btn-text-hover {
      display: block;
    }
    
    .btn-emoji {
      font-size: clamp(12px, 3vw, 20px);
      display: block;
      margin-bottom: 2px;
    }
    
    .btn-text {
      font-size: clamp(8px, 2.5vw, 14px);
      line-height: 1.1;
      display: block;
      font-weight: 900;
    }
    
    /* –¢–µ–∫—Å—Ç –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ */
    .btn-text-hover {
      display: none;
      font-size: clamp(9px, 2.5vw, 15px);
      line-height: 1.2;
      font-weight: 800;
    }
    
    @keyframes bounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-8px);
      }
    }
    
    /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö */
    @media (max-width: 768px) {
      .clickable-zones {
        padding: 15px;
      }
      
      .btn {
        width: 140px;
        padding: 12px 15px;
        font-size: 14px;
      }
      
      .btn-emoji {
        font-size: 24px;
        margin-bottom: 3px;
      }
      
      .btn-text {
        font-size: 11px;
      }
    }
    
    @media (max-width: 480px) {
      .clickable-zones {
        padding: 10px;
      }
      
      .btn {
        width: 120px;
        padding: 10px 12px;
      }
      
      .btn-emoji {
        font-size: 20px;
      }
      
      .btn-text {
        font-size: 10px;
      }
    }
    
    /* –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É */
    .center-button-wrapper {
      position: absolute;
      bottom: 3%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 3;
      pointer-events: all;
    }
    
    .center-btn {
      background: linear-gradient(135deg, #10B981, #059669);
      border: 4px solid #fff;
      border-radius: 20px;
      padding: 10px 8px;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
      cursor: pointer;
      transition: all 0.3s ease;
      animation: bounce 2s infinite;
      min-width: 120px;
      max-width: 180px;
      text-align: center;
    }
    
    @media (min-width: 768px) {
      .center-btn {
        min-width: 180px;
        padding: 12px 20px;
      }
    }
    
    .center-btn:hover {
      transform: scale(1.15) rotate(-2deg);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.5);
      background: linear-gradient(135deg, #34D399, #10B981);
    }
    
    .center-btn:active {
      transform: scale(0.95);
    }
    
    .center-btn-emoji {
      font-size: clamp(18px, 2vw, 24px);
      display: block;
      margin-bottom: 3px;
    }
    
    .center-btn-text {
      font-size: clamp(8px, 2.5vw, 12px);
      line-height: 1.1;
      display: block;
      font-weight: 900;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }
    
    /* === BLUR OVERLAY === */
    .blur-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      backdrop-filter: blur(15px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.5s ease, backdrop-filter 0.5s ease;
    }
    
    .blur-overlay.hidden {
      opacity: 0;
      pointer-events: none;
      backdrop-filter: blur(0px);
    }
    
    /* –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ */
    .login-form {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 40px;
      border-radius: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      min-width: 320px;
      max-width: 400px;
      text-align: center;
      border: 4px solid rgba(255, 255, 255, 0.3);
    }
    
    .login-form h2 {
      color: white;
      font-size: 28px;
      font-weight: 900;
      margin-bottom: 10px;
      text-transform: uppercase;
    }
    
    .login-form p {
      color: rgba(255, 255, 255, 0.9);
      font-size: 14px;
      margin-bottom: 30px;
    }
    
    .login-form input {
      width: 100%;
      padding: 14px;
      margin-bottom: 16px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      outline: none;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }
    
    .login-form input:focus {
      box-shadow: 0 0 0 3px rgba(255, 255, 255, 0.5);
    }
    
    .login-form button {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, #10B981, #059669);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 18px;
      font-weight: 900;
      cursor: pointer;
      text-transform: uppercase;
      box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
      transition: all 0.3s ease;
    }
    
    .login-form button:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
    }
    
    .login-form button:active {
      transform: translateY(0);
    }
    
    /* –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–Ω–æ–ø–æ–∫ –ø–æ–∫–∞ –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω */
    body.locked .zone,
    body.locked .center-btn {
      pointer-events: none;
      opacity: 0.6;
    }
  </style>
  
  <!-- Supabase SDK -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body class="locked">
  <!-- BLUR OVERLAY —Å —Ñ–æ—Ä–º–æ–π –≤—Ö–æ–¥–∞ -->
  <div class="blur-overlay" id="loginOverlay">
    <div class="login-form">
      <h2>üéì –í—Ö–æ–¥</h2>
      <p>–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å</p>
      <input type="text" id="loginInput" placeholder="–õ–æ–≥–∏–Ω" autocomplete="username">
      <input type="password" id="passwordInput" placeholder="–ü–∞—Ä–æ–ª—å" autocomplete="current-password">
      <button onclick="handleLogin()">–í–æ–π—Ç–∏</button>
    </div>
  </div>
  
  <div class="container">
    <div class="image-wrapper">
      <!-- –§–æ–Ω–æ–≤–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞ -->
      <img 
        src="math-trainer_start.jpg" 
        alt="–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–µ–Ω–∞–∂—ë—Ä" 
        class="background-image"
      />
      
      <!-- –ö–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–µ –∑–æ–Ω—ã -->
      <div class="clickable-zones">
        <!-- –õ–µ–≤–∞—è –∑–æ–Ω–∞ - –£–º–Ω–æ–∂–µ–Ω–∏–µ -->
        <div 
          class="zone zone-left" 
          onclick="window.location.href='multiplication.html'"
        >
          <div class="btn">
            <span class="btn-emoji">‚úñÔ∏è</span>
            <span class="btn-text">–£–ú–ù–û–ñ–ï–ù–ò–ï<br>–°–¢–û–õ–ë–ò–ö–û–ú</span>
            <span class="btn-text-hover">–ù–∞–∂–º–∏‚Äî–ø–µ—Ä–µ–π–¥—ë—à—å<br>–∫ —É–º–Ω–æ–∂–µ–Ω–∏—é</span>
          </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –∑–æ–Ω–∞ - –î–µ–ª–µ–Ω–∏–µ -->
        <div 
          class="zone zone-right" 
          onclick="window.location.href='division.html'"
        >
          <div class="btn">
            <span class="btn-emoji">‚ûó</span>
            <span class="btn-text">–î–ï–õ–ï–ù–ò–ï<br>–£–ì–û–õ–ö–û–ú</span>
            <span class="btn-text-hover">–ù–∞–∂–º–∏‚Äî–ø–µ—Ä–µ–π–¥—ë—à—å<br>–∫ –¥–µ–ª–µ–Ω–∏—é</span>
          </div>
        </div>
      </div>
      
      <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤–Ω–∏–∑—É - –û—Å–Ω–æ–≤—ã -->
      <div class="center-button-wrapper">
        <div 
          class="center-btn"
          onclick="window.location.href='basics.html'"
        >
          <span class="center-btn-emoji">üå±</span>
          <span class="center-btn-text">–°–¢–ê–†–¢:<br>–£–ú–ù–û–ñ–ê–ï–ú –ù–ê<br>–û–î–ù–û –ß–ò–°–õ–û</span>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Supabase
    const SUPABASE_URL = 'https://ielcnbcvslloqzmrzzqc.supabase.co';
    const SUPABASE_KEY = 'sb_publishable_oj4Mypwi8KKdReaOpu8AwQ_qtRSotnJ';
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ (–ù–ê–°–¢–û–Ø–©–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ë–î)
    async function handleLogin() {
      const login = document.getElementById('loginInput').value.trim();
      const password = document.getElementById('passwordInput').value.trim();
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–æ–ª—è –Ω–µ –ø—É—Å—Ç—ã–µ
      if (!login || !password) {
        alert('–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω –∏ –ø–∞—Ä–æ–ª—å!');
        return;
      }
      
      try {
        // –ó–∞–ø—Ä–æ—Å –∫ –ë–î: –∏—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º –∏ –ø–∞—Ä–æ–ª–µ–º
        const { data, error } = await supabaseClient
          .from('users')
          .select('*')
          .eq('login', login)
          .eq('password', password)
          .eq('is_active', true)
          .single();
        
        if (error || !data) {
          // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π
          alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å!');
          console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
          return;
        }
        
        // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!
        console.log('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω:', data);
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω
        localStorage.setItem('isLoggedIn', 'true');
        localStorage.setItem('userId', data.id);
        localStorage.setItem('userLogin', data.login);
        
        // –£–±–∏—Ä–∞–µ–º overlay —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
        const overlay = document.getElementById('loginOverlay');
        overlay.classList.add('hidden');
        
        // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
        document.body.classList.remove('locked');
        
      } catch (err) {
        alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Ö–æ–¥–µ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.');
        console.error('–û—à–∏–±–∫–∞:', err);
      }
    }
    
    // –ñ–¥—ë–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    window.addEventListener('DOMContentLoaded', () => {
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ - –∑–∞–ª–æ–≥–∏–Ω–µ–Ω –ª–∏ —É–∂–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
      const isLoggedIn = localStorage.getItem('isLoggedIn');
      
      if (isLoggedIn === 'true') {
        // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω - —Å–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
        const overlay = document.getElementById('loginOverlay');
        overlay.classList.add('hidden');
        document.body.classList.remove('locked');
      }
      
      // Enter –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
      const passwordInput = document.getElementById('passwordInput');
      if (passwordInput) {
        passwordInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter') handleLogin();
        });
      }
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
      const backgroundImg = document.querySelector('.background-image');
      
      if (backgroundImg) {
        if (backgroundImg.complete) {
          document.body.classList.add('loaded');
        } else {
          backgroundImg.addEventListener('load', () => {
            document.body.classList.add('loaded');
          });
          
          setTimeout(() => {
            document.body.classList.add('loaded');
          }, 1000);
        }
      } else {
        document.body.classList.add('loaded');
      }
    });
  </script>
</body>
</html>
